# 开发一个世界时钟

本需求描述一个世界时钟应用。

## 可用接口

本应用仅涉及一个接口，描述如下：

interface TimeResponse {
    value: string; // 当前的时间，为2019-07-08T07:05:34.944Z格式
}

const syncTime = () => Promise<TimeResponse>;

该接口在固定0.8秒后返回`TimeResponse`对象，当请求成功时，`value`属性表示当前时间，**不需要考虑请求响应耗时导致的时间不同步**，以此时间校正所有时钟。当请求失败时，该函数会异步地抛出异常（`Promise#reject`），异常包含`message`说明错误原因。

**首先请实现这个函数**，需要注意以下几点：

1. 固定0.8秒延迟。
2. 无需真正发起请求，直接使用日期相关函数得到当前时间后返回。
3. 制造30%左右的概率发生异常，需注意异步也是在0.8s延迟之后。

## 界面

应用包含一个页面，总体显示为一个网格：

|--------------------------------------|
|   London   |    China   |    Iraq    |
| 2019-07-08 | 2019-07-08 | 2019-07-08 |

| 13:00:00                               | 21:00:00 | 16:00:00 |
| -------------------------------------- | -------- | -------- |
| France                                 |          |          |
| 2019-07-09                             | +        |          |
| 00:00:00                               |          |          |
| -------------------------------------- |          |          |

网络中的每一块表示一个时区的时间，最后一块显示一个“+”字符。

### 页面基本信息

页面最小宽度为1200px，最大宽度为1600，高度不限。

页面四周边距为20px，背景色为纯白（`#fff`）。

### 增加时钟

“+”字符增大字号、加粗，默认状态显示为浅灰色（`#666`），在hover状态下显示为深色（`#333`）。

“+”字符所在区块可点击，点击区域为整个区块（并非+号部分），点击时，该区块显示为一个下拉列表，可选择所有时区。选择完时区后，这个区块变为当前时区的时间显示，“+”字符移动到下一个区块中。

当区块显示为下拉列表时，如点击区块以外的区域，区块重新恢复到“+”字符状态。

选择时区时**不考虑去重**，即同一时区的时钟可以出现多个。

### 删除时钟

时钟可被删除，每一个显示时钟的网格，在hover时会在右上角显示一个宽高均为20px的“X”符号，符号距离网格外边距上部与右部各20px。

“X”符号默认显示为浅灰色（`#666`），hover状态下显示为深色（`#333`）。

点击该符号会直接删除当前的时钟。

### 时间显示

网格上可以有任意数量的时钟，每一个时钟自上而下显示时区、日期、时间三个信息。

每一个网格宽度为350px，文字尺寸为18px，行高为字号2倍。文字在网格内水平和垂直居中。

时区名称使用系统默认字体，日期和时间使用等宽字体。

网格带有浅灰色背景（`#ebebeb`），上下带有10px内边距。

网格在页面上平铺，剩余空间在网格内部平分（`space-between`）。

### 时间同步

系统每1分钟同步一次服务端时间（使用`syncTime`函数），多个时钟**共享一个服务端时间**。同步失败无需做任何展示，静默失败。

在未同步时，时钟以1秒为单位自行改变时钟的显示，且需要将同步时间点校正至秒，即假设服务端时间返回为230ms，则第一次更新时间发生在770ms后，之后恢复至每1s一次的更新。

时间的更新**无需考虑定时器的不准确性**。

### 状态持久化

对于用户添加的时钟，需要在本地持久化存储（使用`localStorage`），用户关闭页面后打开可恢复。

页面信息需要在多个浏览器标签页间同步，即多个标签打开页面时，在一个标签中添加或移除时钟，其它标签而需要同步这一结果。

## 编码要求

### 基本目录结构

/src # 存放业务代码
/dist # webpack打包后的内容
package.json
package-lock.json

注意将不应该进入到Git代码库中的内容放进`.gitignore`中，包括`node_modules`、`dist`等。

### 编码实现

- 可选择React或Vue框架实现。
- 使用NPM或Yarn管理依赖，使用[百度NPM镜像]作为依赖源。
- 使用ES或TypeScript进行编码，模块化使用ES Module。
- 使用LESS作为样式语言。

### 编码规范

所有代码遵循[百度编码规范]中对各语言的规定。

配置使用ESLint进行编码规范检查，使用[@ecomfe/eslint-config]作为规则。

### 构建

使用Webpack构建，确保构建成功，拆分src和vendor至少2个chunk，其它优化自由选择，尽可能地在构建上优化系统。

可使用`webpack-dev-server`进行调试。

使用[百度Node编译环境]进行云端编译，相应配置`ci.yml`，确保Agile编译成功。

### 其它

尽可能地从产品、设计、框架、实现、构建等角度优化系统，表现出自己最好的状态。

如需CDN支持，可参考[百度前端第三方库通用CDN]。